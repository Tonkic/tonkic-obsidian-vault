# 论文
Towards Total Recall in Industrial Anomaly Detection
# 定义
$𝒳_N$表示所有正常的图像的集合，其中$y_x$都为0
ImageNet：一个大型图像数据集
Patch Size：也称为补丁大小，是指在训练神经网络时，将输入图像划分为的小块尺寸。在计算机视觉任务中，图像通常被分割成多个小块，每个小块独立进行训练。这种做法不仅减少了计算量，还使得网络能够更好地捕捉图像的局部特征。
下采样：缩小图像尺寸，通常使用步长为2的池化层
Embedding: 所谓嵌入，指的是将网络提取的不同特征组合到一块;
推理流程：提取Patch特征，再Faiss搜索。Faiss是给定一个向量，在向量库中搜索最相似的向量的算法
# 流程
![[../../../pic/Pasted image 20250217220026.png]]上图的左侧（蓝色虚线框）显示的是学习，右侧（绿色虚线框）显示的是推理流程。

PatchCore使用一个[[卷积神经网络|CNN]]模型从图像中获取特征向量

优化
- 牺牲0.33%的AUROC，换取28.3%的GPU内存峰值降低
- 在每个分块位置上训练一个独立的模型，并且让分块之间存在重叠，从而实现特征空间到像素空间的映射。这种方法能够更好地捕捉空间信息，而重叠部分则通过EfficientAd的预测进行融合，从而提高异常检测的精度
- 如果单个分块检测出异常，那么可以中断，认为整个图像是异常的
- 低吞吐量和高延迟
- ROC曲线以**真正类率（True Positive Rate, TPR**为纵轴，**假正类率（False Positive Rate, FPR**为横轴，通过调整阈值（比如概率0.5表示大于0.5为正例，小于为反例）得出曲线
  
  
 为什么选择“距离最近邻最大的图像块”作为异常块？
假设前提：内存库中所有样本均为正常样本的特征。
异常检测逻辑：
	正常样本的特征在空间中会聚集形成密集区域（正常模式）。
	异常样本的特征会偏离这些聚集区域，距离正常样本越远，异常可能性越高。
操作解释：
	对每个测试图像块，计算其与内存库中所有正常样本的最近邻距离。
	距离越大，说明该图像块越偏离正常模式，因此被视为最可能异常的块。

