---
tags:
  - 计算机网络
---
# 计算机网络基本概念
## 1.计算机网络的定义、组成与功能
### 定义
- 互连的、自治的计算机集合
### 组成
- 硬件
- 软件
- 协议
### 功能
- 通信子网
    - 实现数据通信（底层）
- 资源子网
    - 实现资源共享/数据处理（高层）
## 2.计算机网络的分类
1. **按分布范围分**：
    - **广域网 (WAN)**：使用交换技术
    - **城域网 (MAN)**
    - **局域网 (LAN)**：使用广播技术
    - **个人区域网 (PAN)**
2. **按使用者分**：
    - **公用网**
    - **专用网/内网**
3. **按交换技术分**：
    - **电报交换**：提供直接且独占的链路
    - **报文交换**
    - **分组交换**
4. **按拓扑结构分**：
    - **总线型**
    - **星型**：一个中心节点
    - **环形**
    - **网状型**
5. **按传输技术分**：
    - **广播式网络**：共享公共通信信道
    - **点对点网络**：使用分组存储转发和路由选择机制
## 3.计算机网络的主要性能指标
1. **速率、数据率、数据传输率、比特率**：
    - 表示数字信道上传输数据的速率，单位为位每秒（b/s，kb/s）。
2. **带宽**：
    - 网络设备支持的最高数据传输速率，单位同速率。
3. **吞吐量**：
    - 单位时间内通过网络的数据量，也受带宽或网络速率限制，单位同速率。
4. **时延、延迟、迟延**：
    - 报文/数据包从源到目的地传输的时间，单位为秒。包括：
        - 发送时延（传输时延）
        - 传播时延
        - 排队时延
        - 处理时延
5. **时延带宽积**：
    - 公式：时延带宽积 = 传播时延 × 带宽，表示链路中能容纳的比特数，用于衡量容量。
6. **往返时间 (RTT)**：
    - 从发送方发送数据到接收方确认的时间，包括：
        - 往返传播时延（传播时延×2）
        - 末端处理时间（接收方处理并回复）
7. **利用率**：
    - **信道利用率**：有数据通过时间的比例。
    - **网络利用率**：信道利用率的加权平均值。
# 计算机网络体系结构
## 1.计算机网络分层结构
ISO/OSI参考模型 和 TCP/IP 参考模型 和 五层参考模型
## 2.计算机网络协议、接口、服务等概念
1. **实体**：
    - **第n层实体**：该层的活动元素。
    - **对等实体**：同一层的实体。
    - **SDU**（服务数据单元）：为完成用户需求而传送的数据。
    - **PCI**（协议控制信息）：控制协议操作的信息。
    - **PDU**（协议数据单元）：对等层之间传输的数据单位。
![Pasted image 20241211155520.png](../../pic/Pasted%20image%2020241211155520.png)
1. **协议**：
    - 定义网络中对等实体数据交换的规则、标准或约定，组成部分：
        - **语法**：数据格式。
        - **语义**：功能需求。
        - **同步**：操作顺序。
2. **接口（SAP）**：
    - 上层通过接口访问下层提供的服务。
3. **服务**：
    - 下层为上层提供的功能调用，包含服务原语：
        - **请求**
        - **指示**
        - **响应**
        - **证实**
    - 服务分类：
        - **面向连接与无连接**（如：TCP vs UDP）
        - **可靠与不可靠**
        - **有应答与无应答**
## 3.ISO/OSI参考模型和 TCP/IP 参考模型
### ISO/OSI参考模型
“==应==力==表”== ==会== ==传输== 网络 数据 物理
1. **应用层**：与用户直接交互，提供网络服务。
2. **表示层**：处理数据的表示方式，如格式转换、加密、解密、压缩等。
3. **会话层**：建立、管理和终止会话，确保数据同步与恢复。（SYN）
4. **传输层**：提供端到端的通信，包括可靠性、流量控制、差错控制等。
5. **网络层**：传输的单位是数据报，负责分组的==路由选择==，实现主机间的通信，提供==差错控制== ，==拥塞控制== ，==流量控制==（发送太快时减速）
6. **数据链路层**：将数据报==封装成帧==，确保无差错的数据传输，并进行流量控制和介质访问控制。
7. **物理层**：在物理媒体上传输比特流，定义接口特性（接口的机械形状等）、传输速率和同步方式。
### TCP/IP 参考模型
#### 组成：
1. **应用层**：提供网络服务，支持应用程序的通信。
2. **传输层**：负责端到端的数据传输，常用协议为TCP和UDP。
3. **网际层**：处理不同网络之间的通信，主要协议为IP。
4. **网络接口层**：负责物理设备与网络之间的数据传输。
#### TCP/IP与ISO/OSI对比：
- **ISO/OSI**定义了三大要素：服务、协议、接口，且OSI模型先于协议发明。
- **TCP/IP**模型最初设计解决的是互联问题，注重协议的实际应用和实现。---
tags:
  - 计算机网络
---
# 通信基础
## 1.基本概念
1. **信道 (Channel)**：
    - 信号传输的媒介，具有方向性。可以是有线（如光纤、电缆）或无线（如无线电波、微波）媒介。
2. **信号 (Signal)**：
    - 数据的电气或电磁表现形式，用于在信道中传输数据。信号分为：
        - **数字信号（离散信号）**：只有有限的离散值，通常表示为二进制0和1。
        - **模拟信号（连续信号）**：信号的幅度是连续变化的，可以取任意值。
3. **带宽 (Bandwidth)**：
    - **模拟信号系统**：带宽是最高频率与最低频率之间的差，单位为赫兹（Hz）。
    - **数字设备**：带宽指最高数据传输速率，单位为比特每秒（bps）。
4. **码元 (Symbol)**：
    - 信号的基本波形，代表不同的信息。
	    - 例如，二进制信号的低电平代表0，高电平代表1。
1. **波特 (Baud)**：
    - **码元传输速率**：每秒传输的码元数，单位为波特（Baud）。它描述了信号的变化频率。
2. **速率 (Rate)**：
    - **信息传输速率**：每秒传输的比特数，单位为比特每秒（bps）。与码元传输速率不同，速率关注的是数据传输的数量。
3. **信源 (Source)**：
    - 产生并发送数据的源头，通常是一个计算机、传感器等设备。
4. **信宿 (Sink)**：
    - 接收并处理接收到数据的终点，通常是接收设备或计算机。
## 2.奈奎斯特定理与香农定理
### 相关概念
- **失真**：发送波形和接收到的波形不一样
	- 导致失真的因素包括：
	    - 码元传输速率
	    - 噪声干扰
	    - 传输媒体质量
	- 失真的后果：
		- 码间串扰 (ISI)：接收端收到的信号失去码元之间清晰的界限，造成解码困难。
- **信噪比 (SNR)**：信号的平均功率与噪声的平均功率之比，单位为分贝（dB），公式为 **10 * log₁₀(S/N)**。
### **奈氏准则 (Nyquist Criterion)**
#### 无噪声条件下，为了避免码间串扰，码元传输速率的上限。
- **极限码元传输速率**：在理想低通信道（无噪声，带宽受限）下，为避免码间串扰，极限码元传输速率为 **2W Baud**，其中 W 为信道带宽（单位 Hz）。
- **信道的极限数据传输率**：公式为 **2W * log₂(V)**，其中 V 是每个码元的离散电平数量（即码元种类数）
	- 比如一个码元有8种状态，则一个码元可以表示log₂(8)=3比特数据
	- 注意区别一个是码元速率（Baud/s）一个是数据数率（b/s）
### **香农定理 (Shannon's Theorem)**
- **极限数据传输速率**：在有噪声的带宽受限信道中，为了避免误差，信道的极限数据传输速率为 **W * log₂(1 + S/N)**，其中：
    - W 是信道带宽（单位 Hz）
    - S 是信号的平均功率
    - N 是噪声的平均功率
    - S/N可以通过信噪比得到
## 3.编码与调制
#### 1. **信道上传输的信息分类**
- **基带信号**：数字信号直接传输（近距离，直接用电压高度表示100101）。
- **宽带信号**：数字信号调制成模拟信号后传输（远距离，用波的不同频率表示100101）。
#### 2. **数字数据编码为数字信号**
三种电平：高电平，低电平，负电平
- **归零编码 (RZ)**：每个码元中间发生跳变，前半部分高，后半部分为零。
	- 单极性归零码，前半高表示1，低表示0，后半一定是0
	- 双极性归零码，前半高表示1，负表示0，后半一定是0
- **反向非归零编码 (NRZI)**：前半到后半，翻转表示0，不变表示1；全1时易产生问题。（无法区分时钟信号）
- **非归零编码 (NRZ)**：高表示1，低表示0，无法判断码元的开始和结束。
- **曼彻斯特编码**：每个比特中间有一次跳变，向下跳变表示1，向上跳变表示0，且跳变用于同步，数据速率为调制速率的一半。
- **差分曼彻斯特编码**：中间有跳变，前半部分与前一个码元后半部分同1异0，跳变仅表示时钟信号，支持自同步、抗干扰性强。
- **4B/5B编码**：使用5个比特表示4个数据比特，解决了长期连续0或1的问题，编码效率为80%。
![Pasted image 20241211162710.png](../../pic/Pasted%20image%2020241211162710.png)
#### 3. **数字数据调制为模拟信号**
- **调幅 (AM/ASK)**：改变信号的幅度来表示数据。
- **调频 (FM/FSK)**：改变信号的频率来表示数据。
- **调相 (PM/PSK)**：改变信号的相位来表示数据。
- **QAM (Quadrature Amplitude Modulation)**：调幅和调相结合,以上三种一码元只能携带1b，QAM 一码元能携带几bit
![Pasted image 20241211163722.png](../../pic/Pasted%20image%2020241211163722.png)
#### 4. **模拟数据编码为数字信号**
- **脉冲编码调制 (PCM)**：
    - **采样**：模拟信号周期性扫描，采样率需大于信号最大频率的两倍（奈奎斯特定理）。
    - **量化**：对采样值进行分级，并赋值。
    - **编码**：量化后的值转为二进制编码。
    - **PCM**可以达到较高的保真度。
#### 5. **模拟信号调制为模拟信号**
- 需要高频率，使用**频分复用 (FDM)** 来提高频带利用率。
## 4.电路交换、报文交换与分组交换
####  **电路交换 (Circuit Switching)**
- **流程**：建立连接 → 数据传输 → 释放连接。
- **特点**：建立连接后，源和目的节点独占资源直到数据传输完毕。适用于实时性要求高的大量数据传输（如电话通信）。
#### 2. **报文交换 (Message Switching)**
- **定义**：数据传输单位为“报文”，包含完整的信息（数据、源地址、目的地址、控制信息）。
- **原理**：存储转发，每个报文在传输过程中暂存，直到发送到下一个节点。
- **流程**：报文在网络中逐节点转发。
#### 3. **分组交换 (Packet Switching)**
- **定义**：将数据拆分为小的“分组”进行传输。
- **原理**：类似于报文交换，将报文拆分为分组，包含小数据块和控制信息（源、目的地址、编号等）。
- **分类**：
    - **数据报方式**：每个分组独立传输，不依赖于先前的分组。
    - **虚电路方式**：结合了数据报方式和电路交换方式，建立虚拟链接来传输数据。
![Pasted image 20241211164224.png](../../pic/Pasted%20image%2020241211164224.png)
## 5.数据报与虚电路(分组交换的分类)
####  **数据报服务 (Datagram Service)**
- **目的地址**：每个分组都包含完整的目的地址。
- **路由选择**：每个分组独立地选择路由并转发。
- **分组顺序**：不保证分组按顺序到达。
- **可靠性**：不保证可靠通信，可靠性由用户主机来保证。
- **网络故障适应性**：路径选择可能发生变化，故障节点导致分组丢失，但其他分组可以正常传输。
- **差错处理与流量控制**：由用户主机负责流量控制，网络不保证数据报的可靠性。
#### **虚电路服务 (Virtual Circuit Service)**
- **目的地址**：仅在连接建立阶段使用虚电路号，每个分组使用该号。
- **路由选择**：所有属于同一虚电路的分组按照相同的路径转发。
- **分组顺序**：保证分组按顺序到达。
- **可靠性**：网络保证可靠性。
- **网络故障适应性**：若虚电路中途的节点出现故障，经过该节点的虚电路无法正常工作。
- **差错处理与流量控制**：可以由分组交换网络或用户主机负责。
# (二)传输介质
## 1.双绞线、同轴电缆、光纤与无线传输介质
#### **导向性传输介质 (Guided Media)**
电磁波沿固体传播
- **双绞线**：10BASE-T
- **同轴电缆**：10BASE-2和10BASE-5
#### **非导向性传输介质 (Unguided Media)**
电磁波通过自由空间传播，如空气。
- 无线传输介质
	- **无线电波**：WIFI
	- **微波**：地面微波通信、卫星通信。
	- **红外光、激光**
- 光纤：10BASE-F，光纤（Fiber）
## 2.物理层接口的特性
1. **机械特性**
    - 接口尺寸、形状、引脚数量与排列。
2. **电气特性**
    - 电压范围、传输速率、带宽限制。
3. **功能特性**
    - 电压电平代表的含义，每条线的功能（如电源线、信号线）。
4. **规程特性**
    - 信号传输方式、时序、协议规定等过程特性。
# (三)物理层设备
## 1. **中继器**
- **功能**：再生数字信号，增加传输距离。
- **5-4-3准则**：一条线路最多可有5个网段、4个中继器，且只有3个网段能接网络设备。
- **限制**：仅作用于电气信号，不能连接速率不同的局域网。
## 2. **集线器/多口中继器**
- **功能**：多个端口的中继器，是共享设备。
- **限制**：无法分割冲突域和广播域，所有设备共享带宽。---
tags:
  - 计算机网络
---
# 数据链路层的功能
### 1. **为网络层提供服务**
- 服务类型
	- **无确认无连接**
	- **有确认无连接**
	- **有确认面向连接**
### 2. **链路管理**
### 3.**组帧**
- 将数据封装为帧，实现
	- 帧同步（区分帧的开始和终止）
	- 透明传输（数据无论如何组合都可传送）。
- **组帧方法**：
	- **字符计数法**：帧首部使用计数字段表示帧内字符数，易受攻击。
	- **字符填充法**：为避免数据与标志序列冲突，使用转义字符。
	- **零比特填充法**：连续5个0后添加一个0。
	- **违规编码法**：例如曼彻斯特编码头部和尾部就使用 高高/低低 两种在数据部分不会出现的字段 来界定边界，HDLC中5个连续1插0
### 3. **流量控制**
- 限制发送方的发送速率。
### 4. **差错控制**
- **检错编码**：
	- **奇偶校验**：
		- 奇校验：这串序列1的个数如果为偶数则在前面加个1，使1的个数变成奇数，否则加0。
	    - 偶校验：这串序列1的个数如果为奇数则在前面加个1，使1的个数变成偶数，否则加0。
	- **循环冗余码（CRC）**：
	- 双方约定一个多项式G（x）
	    - 如$x^3+x^2+1$表示1101
	- 要传输的数据后面加0
	    - G（x）的阶为r，就加r个0
        - 如$x^3+x^2+1$ 3阶，要传输1101011->1101011000
- 对数据使用模2除法
    - 得到的余数做完FCS加在数据后
    - 模二除不进位不借位，相当于异或
	    - 如1101011 000除1101得1000010余100
	    - 就把100加到最后得到1101011 100发送
	    - 接收方收到数据后，如果1101011 100除1101余0则认为正确
- **纠错编码**：
	- **海明码**：可纠正1位错误，检测2位错误，使用校验位定位错误位。
	- n为有效信息位数，k为检验位位数，$n+k\leq 2^k -1$
		- - `2^k` 表示：`k` 个校验位对应 `2^k` 种状态
		- `n + k + 1` 表示：`n + k` 代表任何一位都可能出错，`1` 代表一种正确的状态
		- 比如数据位8位，就是n=8，代入得到k至少为4
	- 为了检测e个位错，海明距离至少为e+1。
	- 为了纠正t个位错，海明距离至少为 2t+1。
	- 海明距离：字符串之间不同的位数
# 组帧
[数据链路层 \> 3.\*\*组帧\*\*](../计算机网络/数据链路层.md#3.**组帧**)
# 差错控制
[数据链路层 \> 4. \*\*差错控制\*\*](../计算机网络/数据链路层.md#4.%20**差错控制**)
# 流量控制与可靠传输机制
## 1. 流量控制、可靠传输与滑动窗口机制
流量控制用于调节发送方的发送速率，防止接收方处理不及导致数据丢失
## 2. 停止-等待协议
在停止-等待协议中，发送方每发送一个帧，必须等待接收方的确认（ACK）后才发送下一个帧。
- **无差错情况**：数据帧成功传输，接收方及时回复确认。
- **有差错情况**：如果数据帧丢失或出错，接收方不发送确认信号，发送方会超时重发。若ACK丢失，发送方会重发确认。
## 3. 后退N帧协议 (GBN)
GBN是滑动窗口协议的一个例子，其中发送方和接收方各自维护一个滑动窗口。发送方可以在窗口内同时发送多个帧，但只允许按顺序确认。
- **滑动窗口的长度** $- 1 \leq W \leq 2^n - 1$
        - W滑动窗口长度
        - n是n个比特对帧编号
- **接收窗口长度**为1
- **累计确认**：接收方可以累计确认，意味着接收到多个帧后只返回一个确认，表示所有前面的帧都已正确接收。
- **必须顺序接收**：接收方按顺序接收帧，不会接受乱序的帧（如果接收方期望的是帧3，但收到的是帧4，则丢弃帧4并一直等待帧3）。
- 对于丢失分组 n，在GBN中，发送方会重传n及n以后的数据包；在SR中，只会重传n。
## 4. 选择重传协议 (SR)
- **发送方**：发送方根据接收方的反馈只重发出错的帧。
- **接收方**：接收方在接收到错误帧时发送NAK请求，要求重发该帧。
**滑动窗口长度**：
- 发送窗口的长度通常等于接收窗口的长度。
- 设定条件： $W_r + W_t \leq 2^n$，其中 $W_r$ 是接收窗口，$W_t$ 是发送窗口，且 $W_r \leq W_t$，不然接收窗口填不满，多出来的无用.
### 信道利用率
信道利用率表示在一个发送周期内有效传输数据的时间占总时间的比率，公式为：  
$\text{信道利用率} = \frac{L}{C} \times \frac{1}{T}$
其中：
- ( L ) 是传输的数据量（比特），
- ( C ) 是传输速率，
- ( T ) 是发送周期，是从发送数据到接收到第一个确认帧所需要的总时间，包括发送方的发送时延、往返时延（RTT）以及接收方确认分组的发送时延。
# 介质访问控制
## 1.信道划分
1. **频分多路复用 FDM**：每个设备在自己分配的频段上进行通信，成熟且效率高。
2. **时分多路复用 TDM**：将时间划分为多个时隙，设备在各自的时隙内发送数据。其改进形式——统计时分复用（STDM），根据实际需求动态分配时隙，提高了带宽利用率。
3. **波分多路复用 WDM**：在光通信中，通过将光信号在不同波长上传输，进行频分多路复用。
4. **码分多路复用 CDM**（或码分多址 CDMA）：使用正交码对设备进行区分，收到码片序列正交后，1发送1，0表示没发送数据，-1表示发送0
		例：
		A:(-1 -1 -1 +1 +1 -1 +1 +1) B:(-1 -1 +1 -1 +1 +1 +1 -1)
		C:(-1 +1 -1 +1 +1 +1 -1 -1) D:(-1 +1 -1 -1 -1 -1 +1 -1)
		现收到这样的码片序列:( +1 -3 +3 -1 +1 +1 +1 +1)
		A：-1+3-3-1+1-1+1+1=0 ，A站点没有发送数据。
		B：1/8(-1+3+3+1+1+1+1-1)=1，表示B站发送的信息是+1。
		C：1/8(-1-3-3-1+1+1-1-1)= -1，表示C站发送的信息为0。
		D：1/8(-1-3-3+1-1-1+1-1)=-1，表示D站发送的信息为0。
## 2.随机访问
1. **ALOHA 协议**：
    - **纯 ALOHA**：发送方在任何时刻发送数据，冲突时超时重传。
    - **时隙 ALOHA**：时间分成固定时隙，冲突发生后等下一个时隙开始时重传。
2. **CSMA 协议**（载波监听多路访问）：
    - **CS**：发送前监听信道。
    - **MA**：允许多个设备接入。
    - 分类：
        - **1-坚持 CSMA**：信道空闲时立即发送，忙时继续监听。
        - **非坚持 CSMA**：信道空闲时发送，忙时等待随机时间后再监听。
        - **p-坚持 CSMA**：根据信道状态的概率继续监听。
3. **CSMA/CD 协议**（载波监听多点接入/碰撞检测）：
    - 发送前和发送中监听信道。
    - 只要经过 2τ 时间还没有检测到碰撞，此次发送一定不会发生碰撞
    - 截断二进制指数规避算法
	    - 重传次数 k
	        - k = min（重传次数，10）
	    - 重传需要的退避时间= r\*2τ
	        - 0 < r < $2^k -1$，中取随机数,上限1023
	    - 重传达到 16次 仍然失败。抛弃此帧，向上层报告错误
    - 最小帧长问题
	    - 如果帧过短，还没检测到冲突，数据帧就发送完毕
	    - 最小帧长 对应的 发送时延 要 大于 2τ
	    - 帧长/数据传输速率>=2RTT（RTT≈链路长度/信号传播速率）
1. **CSMA/CA 协议**（载波监听多点接入/碰撞避免）：
    - 应用于无线局域网（如Wi-Fi）。
    - **帧间间隔（IFS）**：包括SIFS<PIFS<DIFS ；小SPD大

| **发送方**                                           | **接收方**                          |
| ------------------------------------------------- | -------------------------------- |
| 监听信道，等待空闲DIFS时间后，发送RTS（请求发送），包含发射端地址、接收端地址、数据持续时间 |                                  |
|                                                   | 收到RTS，并等待SIFS时间，发送CTS            |
| 收到CTS后，等待SIFS时间，开始发送数据帧，并预约信道                     |                                  |
|                                                   | 接受数据帧并通过CRC验证校验其正确性，若数据正确，则发送ACK |
| 收到ACK帧后，发送下一帧，若未收到ACK，则使用二进制指数退避算法重传数据            |                                  |
## 3.轮询访问
### 令牌传递协议
- 令牌
    - 一个特殊格式的MAC控制帧，不含任何信息
    - 控制信道的使用，确保同一时刻只有一个结点独占信道
- 令牌持有时间有上限，不能无限制长时间持有令牌
- 适用于负载较重、通信量较大的网络中
# 局域网
## 1.局域网的基本概念与体系结构
### 局域网
- **使用广播信道**：局域网通过广播信道进行通信。
- **数据传输率**：10Mb/s到10Gb/s。
- **通信方式**：采用分布式控制和广播式通信，支持广播和组播。
### 分层
- **LLC子层（逻辑链路控制子层）**：识别网络层协议并进行封装，为网络层提供服务。
- **MAC子层（介质访问控制子层）**：
    - 负责数据帧的封装与解封装。
    - 进行帧寻址、识别、接收、发送、管理和差错控制。
    - 屏蔽不同物理链路的差异性。
## 2. 以太网与 IEEE 802.3
- **标准**：IEEE 802.3，使用CSMA/CD协议。
- **功能**：无差错接收，不实现可靠传输。
- **拓扑结构**：逻辑上总线型，物理上星型。
- **编码**：使用曼切斯特编码（上下）
- **相关概念**：
    - **适配器**：网卡，进行数据串并转换。
    - **MAC地址**：48位物理地址，前24位为厂家地址，后24位为厂家自定义
    - **MAC帧**：数据部分46-1500字节，FCS校验（使用CRC-32得到），帧无需结束定界符。因为最小帧长64B，64-6-6-2-4=46B

| 8B                         | 6B   | 6B  | 2B                  | 46-1500B | 4B  |
| -------------------------- | ---- | --- | ------------------- | -------- | --- |
| 前导码=<br>7B同步用+<br>1B帧开始界定符 | 目的地址 | 源地址 | 类型<br>IPV4/6<br>ARP | 数据       | FCS |

## 3. IEEE 802.11无线局域网
- **标准**：IEEE 802.11，使用CSMA/CA协议。
- **MAC帧头结构**：（源地址在无线桥接下才使用）

| 2B  | 2B   | 6B  | 6B  | 6B   | 2B   | 6B  | 4B  |
| --- | ---- | --- | --- | ---- | ---- | --- | --- |
| 帧控制 | 生存周期 | 接收端 | 发送端 | 目的地址 | 序列控制 | 源地址 | FCS |
- **MAC帧主体和帧尾结构**：

| 0-2312B | 4B  |
| ------- | --- |
| 数据      | FCS |

## 4. VLAN 基本概念与基本原理
- 在以太网帧的源地址和类型中间插入VLAN标签
- VLAN标签
    - 长四字节
    - 前两个字节为0x8100表示这是802.1Q帧
    - 后两个字节的后12位为VID表示帧属于哪个VLAN
# 广域网
## 1.广域网的基本概念
- 通常跨越很大的物理范围、几十公里到几千公里。跨国、跨洲
## 2.PPP协议
- **全双工链路**：只支持全双工通信。
- **组成部分**：
    - **链路控制层协议（LCP）**：负责身份验证，建立和维护数据链路连接。
    - **网络控制协议（NCP）**：支持多种网络层协议，每种协议使用对应的NCP来配置并建立逻辑连接。
- **帧格式**：帧开始+地址+控制+协议（指明数据如何解读）+FCS+帧结束
# 数据链路层设备
- **网段**：同一物理层设备下，能够直接通信的网络部分。一个网段属于一个冲突域。
- **网桥**：根据MAC地址转发和过滤帧。
    - **透明网桥**：不影响站点，站点不知道经过的网桥。
    - **源路由网桥**：帧头包含路由信息。
- **以太网交换机**（多接口网桥）：
    - **直通式交换机**：根据目的地址直接转发，优点是延迟小，但可靠性低，且不支持不同速率端口交换。
    - **存储转发式交换机**：检查帧是否正确，错误丢弃，优点是可靠性高，支持不同速率端口交换，但延迟大。
- **冲突域**：同一时间只能有一台设备发送信息的范围。
- **广播域**：广播信号可被所有设备接收的范围。
### 设备说明
- **中继器**：增强基带信号，传输模拟信号。
- **放大器**：增强宽带信号，传输数字信号。
- **集线器**：共享式以太网。
- **交换机**：交换式以太网。---
tags:
  - 计算机网络
---
# (一)网络层的功能
## 1. **异构网络互连**  
网络层通过不同类型的中继器互连各种异构网络，包括物理层的转发器和集线器、数据链路层的网桥和交换机、网络层的路由器及更高层的网关。
## 2. **路由与转发**
- **转发**：数据包根据目的地址从一个节点转发到下一个节点（数据平面）。
- **路由控制**：决定最佳路径的选择（控制平面）。
## 3. **SDN 基本概念**
- 传统路由器有控制平面和数据平面，SDN将控制平面集中化，数据平面分布式。路由器不再相互交换信息，而是逻辑上的远程控制器（可能由多个服务器组成）通过Openflow协议将转发表（在SDN中被称为流表）下发给路由器
- **北向接口**：SDN的编程接口。
- **南向接口**：控制器与转发设备之间的接口。
- **东西向接口**：SDN控制器之间的接口。
## 4. **拥塞控制**
- **拥塞**：过量数据包导致网络性能下降。
- **控制方式**：
	- **开环控制**：静态预防拥塞。
	- **闭环控制**：动态根据网络状况调整，基于反馈进行拥塞控制。
# (二)路由算法
## 1. **静态路由与动态路由**
- **静态路由**：由管理员手动配置，适用于安全性要求高或规模较小的网络。缺点是更新较慢，不适应网络拓扑或链路的变化。
- **动态路由**：路由器之间自动交换信息，依据网络拓扑和链路状态动态调整路由。适用于大规模网络，能够及时响应网络变化，但算法复杂，可能增加网络负担。
- 默认路由：0.0.0.0/0
## 2. **距离-向量路由算法**
- 路由器仅知道与直接连接的邻居的网络信息，使用“距离”来表示路由的优劣。
- 常见协议：**RIP**
## 3. **链路状态路由算法**
- 路由器掌握完整的网络拓扑信息，包括所有链路的状态和费用，通过算法计算出最佳路径。
- 常见协议：**OSPF**（Open Shortest Path First）
## 4. **层次路由**
- 将大网络划分为多个自治系统（AS）
- AS之间使用BGP协议通信
	- BGP借助TCP实现
	- 触发更新
# (三)IPv4
## 1.IPv4 分组
#### 1. **IPv4数据报格式**
![Pasted image 20241212202118.png](../../pic/Pasted%20image%2020241212202118.png)
IPV4数据报包括**首部**和**数据**两部分。
- **首部固定部分**：20字节，包括关键字段。
- **可选部分**：用于提供错误检测、安全等功能，长度可变。
#### 2. **重要字段含义**
1. **版本**（4位）：表示IP版本，当前为IPv4。
2. **首部长度**（4位）：单位为4字节，最大值15（通常为5(20B)，表示无可选字段）。
3. **总长度**（16位）：IP数据报的总长度（首部+数据），最大65535字节。
4. **标识**（16位）：每个数据报分片共享同一标识，用于重组。
5. **标志**（3位）：
    - **DF (Don't Fragment)**：如果DF=1，禁止分片；DF=0，允许分片。
    - **MF (More Fragment)**：如果MF=1，表示还有更多分片；MF=0，表示这是最后一个分片。
6. **片偏移**（13位）：表示该分片在原数据报中的相对位置，单位为8字节。
   - 所以分片大小都是8B的整数倍
7. **首部校验和**（16位）：仅校验IP数据报的首部。
8. **生存时间TTL**（8位）：数据报在网络中可经过的最大路由器数，防止数据报在网络中无限循环。
9. **协议**（8位）：表示数据部分使用的传输层协议（如TCP、UDP等）。
10. **源地址**（4字节）：发送方IP地址。
11. **目的地址**（4字节）：接收方IP地址。
助记：1总8片首4（一种八片首饰）
#### 3. **IP数据报分片**
- **分片原因**：当数据报大小超过链路层的最大传输单元（MTU）时，需要进行分片。例如，以太网的MTU为1500字节。
- **分片过程**：分片后的数据报每片具有相同的标识，且每片的长度必须是8字节的倍数，最后一个分片可能不是8字节的整数倍。
#### 4. **网络层转发分组流程**
1. 提取数据报的目的IP地址，得出目的网络地址。
2. 如果路由器直接连接到目的网络，则交付数据报。
3. 否则，查找路由表：
    - 如果有到特定主机的路由，转发给下一跳路由器。
    - 如果有到目的网络的路由，转发给下一跳路由器。
    - 如果没有指定路由，则使用默认路由。
4. 若没有匹配路由，报告转发错误。
- 当数据报超过链路层的最大传输单元 (MTU) 时，需要进行分片。分片后的数据报会在目的主机上重新组装。
## 2.IPv4地址与NAT
#### 1. **IPv4地址**
![Pasted image 20241212204213.png](../../pic/Pasted%20image%2020241212204213.png)
A和B中间的127给扣了，作为本地环回地址

| **NetID/网络号** | **HostID主机** | **作为IP分组源地址** | **作为IP分组目的地址** | **用途**                                 |
| ------------- | ------------ | ------------- | -------------- | -------------------------------------- |
| 全0            | 全0           | 可以            | 不可以            | 本网范围内表示主机，路由表中用于表示默认路由(表示整个Internet网络) |
| 全0            | 特定值          | 可以            | 不可以            | 表示本网内某个特定主机                            |
| 全1            | 全1           | 不可以           | 可以             | 本网广播地址（路由器不转发）                         |
| 特定值           | 全0           | 不可以           | 不可以            | 网络地址，表示一个网络                            |
| 特定值           | 全1           | 不可以           | 可以             | 直接广播地址，对特定网络上的所有主机进行广播                 |
| 127           | 任何数(非全0/1)   | 可以            | 可以             | 用于本地软件环回测试，称为环回地址                      |
#### 2. **网络地址转换（NAT）**
- **私有IP地址**：用于局域网，不能直接连接到Internet，需通过NAT转换成公网IP。
- **专用互联网/本地互联网**：使用私有IP的网络称为专用互联网，私有IP地址可在多个局域网中重复使用。
- **NAT工作原理**：NAT路由器通过转换表将本地IP地址映射到公网IP，实现内外网通信。多个私有IP可共享一个公网IP。
	- 内网发到公网：路由器替换LAN口地址（源地址）为WAN口地址（路由器地址）
	- 公网发到内网：使用NAPT，路由器通过端口确定数据报是发给哪一台主机的，如果某个端口已经被使用，顺延+1
## 3.子网划分、路由聚集、子网掩码与 CIDR
### **子网划分**
- **思想：** 将IP地址中的主机号的前几位借用作为子网号。
- **子网掩码：** 用于区分IP地址中的网络号、子网号和主机号。子网掩码通过“与”运算得出子网地址。
- **例子：**
    - IP地址：192.168.5.56
    - 子网掩码：255.255.255.0
    - 结果：子网地址为 192.168.5.0
### **CIDR（无分类域间路由选择）**
- **背景：** 由于A、B、C类地址的划分不够灵活，CIDR应运而生，它允许更灵活地定义网络前缀和主机地址。
- **CIDR表示法：** 使用“网络前缀/子网掩码长度”的方式，例如 `192.168.1.0/24` 表示前24位为网络前缀。
### **路由聚合与最长前缀匹配**
- **路由聚合：** 将多个子网聚合成一个更大的网络，减少路由表的大小。
- **最长前缀匹配：** 路由器根据目的地址选择最具体的路由条目，匹配最长的网络前缀。
## 4.ARP协议、DHCP协议与ICMP协议
1. **ARP协议（地址解析协议）**:
    - **目的**: 通过IP地址到MAC地址的映射，确保数据链路层传输的MAC帧能够准确送达。
    - **工作原理**: 
	    - 首先查找ARP表。
	    - 如果没有匹配的MAC地址，发送广播ARP请求(MAC目的地址全1)
	    - 目的主机回应ARP响应，携带自己的MAC地址。
    - **ARP表**: 存储IP地址与MAC地址的映射，每10-20分钟更新一次。
2. **DHCP协议（动态主机配置协议）**:
	**发现报文**: 客户端广播请求DHCP服务器提供配置。
	- 0.0.0.0-255.255.255.255
	**提供报文**: DHCP服务器响应，提供可用的IP地址和配置信息。
	- server_ip-255.255.255.255
	**请求报文**: 客户端选择一个DHCP服务器，并发出请求；即使租用期过期也会重新发送。
	- 0.0.0.0-255.255.255.255
	**确认报文**: DHCP服务器确认分配的IP地址及配置，完成过程。
	- 除了确认报文都是广播
1. **ICMP协议（网际控制报文协议）**:
	- **差错报文**: 
		- "终点不可达"
		- "源点抑制"（放慢发送速率）
		- "时间超过"（TTL为0）
		- 参数问题
		- 改变路由（有更好的路由）
	- **询问报文**: 
		- 回送请求和回答报文
			- 测试目的站是否可达
		- 时间戳请求和回答报文
			- 用来主机与路由器同步时钟
		- 地址掩码请求和回答报文
		- 路由器询问和通告报文
	- **不应发送**：
		1. 对于ICMP报文本身的错误，不应再发送差错报告。
		2. 只对IP分片的第一个分片发送错误报告，后续分片不再发送。
		3. 对于多播（组播）地址的差错，不发送报告。
		4. 对于如127.0.0.1或0.0.0.0等特殊地址，不发送差错报文。
# (四)IPv6
### 2. **IPv6 地址**
- **版本**: 协议版本：6。
- **优先级**: 区分数据报的类别和优先级。
- **流标签**: 标识来自同一源到同一目的地的一系列数据报。
- **有效载荷长度**: 包含扩展首部和数据的总长度。
- **下一个首部**: 指示下一个扩展首部或数据部分。
- **跳数限制**: TTL（生存时间）。
![Pasted image 20241212220038.png](../../pic/Pasted%20image%2020241212220038.png)
### **IPv6 地址的表示形式**
- **一般形式**: 冒号十六进制记法。
- **压缩形式**: 连续四个零用一个零表示（:0000:=>:0:）；连续零可以通过双冒号表示（双冒号只能出现一次）。（:0000:0000:=>::）
### **IPv4 与 IPv6 兼容**
- **双栈协议**: 同时启用IPv4和IPv6协议栈。
- **隧道技术**: 将IPv6数据包封装为IPv4数据包进行传输。
### **IPv6 与 IPv4 的区别**
- **地址长度**: IPv6地址为128位，IPv4为32位。
- **可选字段**: IPv6移除可选字段，减少路由器处理时间，路由器不处理扩展首部。
- **即插即用**: IPv6支持即插即用，IPv4需依赖DHCP。
- **数据报长度**: IPv6长度为8B的整数倍，IPv4为4B的整数倍。
- **分片**: IPv6只能由主机进行分片；IPv4由路由器和主机分片，目标主机负责组装。
- **MTU超限**: 如果分组超过MTU，路由器丢弃并通过ICMPv6通知源主机。
# (五)路由协议
## 1.自治系统
## 2.域内路由与域间路由
内部使用RIP（UDP）/OSPF（IP），外部使用BGP（TCP）
- ru oi bt
## 3.RIP 路由协议
- **路由表特点**：维护到每个目的网络的唯一最佳==下一跳地址==与==距离==，最大跳数为15，16表示不可达。
- **信息交换**：仅与相邻路由器交换路由表，每30秒更新一次。
- **收敛**：通过多次交换更新后，所有路由器最终会收敛，知道到达本自治系统所有网络的最短路径和下一跳路由器。
- **优缺点**：好消息传递较快，坏消息传递较慢
## 4.OSPF 路由协议
- 拓扑中的每台路由器都在整个拓扑的范围内泛洪自己的链路状态通告（LSA），每台路由器都会获得整个拓扑中其它所有路由器的 LSA。
	- LSA存储 连接自己的所有边 及 边的代价
	- 边内容包含目的路由器ID和目的路由器IP
## 5.BGP 路由协议
- 边界发言人交换路径向量
### 四种报文
1. OPEN(打开)报文:用来与相邻的另一个BGP发言人建立关系，并认证发送方。
2. UPDATE(更新)报文:通告新路径或撤销原路径。
3. KEEPALIVE(保活)报文:在无UPDATE时，周期性证实邻站的连通性:也作为OPEN的确认。
4. NOTIFICATION(通知)报文:报告先前报文的差错:也被用于关闭连接。
# (六)IP组播
- **单播、广播、多播/组播**:
    - **单播**: 一对一通信。视频服务器给90个客户端发同一份视频要发90个请求
    - **多播**: 一对多通信，视频服务器给90个客户端发同一份视频只要发1个请求
- **组播协议**:
    - **IGMP协议**: 让路由器知道局域网内是否有主机参加或退出某个组播组。
    - **组播路由选择协议**: 寻找以源主机为根的组播转发树。
- **硬件组播**:
    - 组播MAC地址以 `01-00-5E` 开头，后6个十六进制位根据IP组播地址的最后23位转换得到。
    - 地址范围: `01-00-5E-00-00-00` 到 `01-00-5E-7F-FF-FF`。
- **IP组播地址**:
    - 范围: `224.0.0.0` 到 `239.255.255.255`，属于D类地址。
    - 用于UDP，尽最大努力交付数据。
    - 不产生ICMP差错报文。
    - 不是所有D类地址都可以用作组播地址。
# (七)移动IP
## 1. 移动IP的概念
- **目标**: 使移动结点（计算机、服务器等）在跨越不同网段时保持固定的网络IP地址，实现漫游功能，并保证网络权限不受影响。
- **移动结点**: 具有固定IP地址的设备，在不同网络之间移动。
- **归属代理/本地代理**: 初始或归属地的代理，用于管理移动结点的网络连接。
- **永久地址/归属地址/主地址**: 移动结点的固定IP地址。
- **外部代理/外地代理**: 移动结点所在的外部网络的代理。
- **转交地址/辅地址**: 用于外部网络中的地址，确保移动结点在不同网络间的连接。
## 2. 移动IP通信过程
#### 简单总结：发送接受都需要经过归属网络，让本地代理代完成
A使用移动IP，B在广域网中
1. **A刚进入外部网络**：
    - 在外部代理登记获得转交地址，离开时注销。
    - 外地代理向本地代理登记转交地址。
2. **B给A发送数据报**：
    - 本地代理截获数据报（当主机A不在时）。
    - 本地代理封装数据报，将目的地址修改为转交地址，并通过隧道发送给外部代理。
3. **A给B发送数据报**：
    - A使用自己的主地址作为源地址，B的IP地址作为目的地址发送数据报。
4. **A移动到下一个网络**：
    - 在新外部代理注册转交地址。
    - 新外部代理将新转交地址发送给本地代理，覆盖旧地址。
    - 数据通信继续。
5. **A回到归属网络**：
    - A向本地代理注销转交地址。
    - 恢复原始通信方式。
# (八 )网络层设备
## 1. 路由器的组成和功能
- **路由器**: 是具有多个输入端口和输出端口的专用计算机，主要用于不同网络之间的连接与数据转发。
- **输入/输出队列溢出**: 路由器在转发数据时，输入或输出队列的溢出是导致分组丢失的一个重要原因。
## 2. 路由表与分组转发
- **路由表**: 通过路由选择算法生成，软件实现，用于决定数据包的转发路径。
- **转发表**: 由路由表得来，可以通过软件或硬件实现。转发表的每一行包含目的网络到输出端口及相关MAC地址的映射。
## 三层设备区别
- **路由器**: 可以互联不同网络层协议的网段（例如，IP协议间的互联）。
- **网桥/交换机**: 可以互联不同物理层和链路层的网段（例如，连接不同局域网）。
- **集线器**: 只能在同一物理层的网段内工作，无法互联不同的物理层网段。
---
tags:
  - 计算机网络
---
# 传输层提供的服务
## 1. 传输层的功能
- **进程间通信**：传输层为同一主机上不同进程之间提供逻辑通信。
- **复用与分用**：
    - **复用**：将多个应用进程的通信信息合并后交给网络层。
    - **分用**：根据端口号将从网络层收到的数据交给不同的应用进程。
- **差错控制**：传输层通过机制确保数据传输的正确性。
## 2. 传输层寻址与端口
- **端口号**：
    - **功能**：端口号用于标识主机上的应用进程。
    - **范围**：16位端口号，共有65536个端口。
    - **分类**：
	    - **服务端端口**：
	        - **熟知端口**：0-1023
	        - **登记端口**：1024-49151
	    - **客户端端口**：49152-65535
- **套接字（Socket）**：由主机IP地址和端口号唯一标识一个进程。
## 3. 无连接服务与面向连接服务
- **无连接服务**：如UDP，不需要建立连接即可进行数据传输。
- **面向连接服务**：如TCP，需要先建立连接并维护连接状态。
# UDP协议
## 1.UDP 数据报
![Pasted image 20241212232050.png](../../pic/Pasted%20image%2020241212232050.png)
### udp复用和分用
- 复用
	- 发送方把多个应用数据报打包发送
- 分用
	- 接收方把收到的打包数据报拆开分发给各个应用
## 2.UDP 校验
- 伪首部：计算校验和时才出现，不传递
    - 17 表示UDP协议
    - UDP 长度 首部 8B + 数据部分
![Pasted image 20241212232124.png](../../pic/Pasted%20image%2020241212232124.png)
### 校验和计算
#### 二进制反码求和
- 就是加数和被加数都取反然后相加，需要计算进位
- 如果最高位进1就把那个1 拿下来 加到最后面去。
#### 在发送端:
1. 填上伪首部
2. 全0填充检验和字段
3. 全0填充数据部分(UDP数据报要看成许多4B的字串接起来)
4. 伪首部+首部+数据部分采用二进制反码求和
5. 把和求反码填入检验和字段
6. 去掉伪首部，发送
#### 在接收端:
1. 填上伪首部
2. 伪首部+首部+数据部分采用二进制反码求和
3. 结果全为1则无差错，否则丢弃数据报/交给应用层附上出差错的警告
![Pasted image 20241212232157.png](../../pic/Pasted%20image%2020241212232157.png)
# TCP协议
## 1.TCP 段
![Pasted image 20241212232221.png](../../pic/Pasted%20image%2020241212232221.png)
- **序号 (Seq)**：表示发送数据的第一个字节的序号，用于确保数据按顺序传输。
- **确认号 (Ack)**：表示期望收到的下一个数据的序号，确认号为 N 时，表示数据号为 N 前的所有数据已正常接收。
- **数据偏移**：指示数据部分相对于报文段起始部分的位置，单位为4字节。
- **控制位**：
    - **URG**：紧急位，表示报文含有紧急数据，配合紧急指针使用。
    - **ACK**：确认位，表示确认号有效。连接建立后，所有报文段的ACK位应为1。
    - **PSH**：推送位，表示接收方应尽快将数据交给上层。
    - **RST**：复位位，表示连接出错，需重新建立连接。
    - **SYN**：同步位，表示连接请求或接收。
    - **FIN**：终止位，表示数据发送完毕，要求释放连接。
- **窗口 (Window)**：接收方的接收窗口大小，控制允许发送方发送的数据量。
- **检验和 (Checksum)**：用于校验报文段的完整性，计算时包括伪首部。
- **紧急指针**：仅当URG=1时有效，表示报文段中的紧急数据字节数。
- **选项**：
    - **最大报文段长度 (MSS)**：指定TCP报文段最大数据载荷的长度。
    - **窗口扩大选项**：用于扩大接收窗口，提高吞吐率。
    - **时间戳选项**：用于计算往返时间（RTT）并防止序号溢出（PAWS）。
    - **选择确认 (SACK)**：允许接收方选择性确认已接收的非连续数据。
## 2.TCP 连接管理
### 假设发送端A，接受端（服务端）为B
#### 三次握手过程中seq和ack
| 方向   | seq   | ack   | SYN | ACK |
| ---- | ----- | ----- | --- | --- |
| A->B | 10000 | 0     | 1   | 0   |
| B->A | 20000 | 10001 | 1   | 1   |
| A->B | 10001 | 20001 | 0   | 1   |
#### 数据传输过程中seq和ack的值
| 方向   | seq   | ack              | 数据长度 | 数据包长度 |
| ---- | ----- | ---------------- | ---- | ----- |
| A->B | 40000 | 70000            | 1460 | 1518  |
| B->A | 70000 | 40000+1460=41460 | 0    | 54    |
| A->B | 41460 | 70000            | 1460 | 1518  |
| B->A | 70000 | 41460+1460=42920 | 0    | 54    |
##### 注
1. 只有发送了1B有效数据才会使seq+1
2. 在三次握手的时候+1是因为标志位的SYN同步标志占用了1，并且三次握手是没有数据的，所以只加了1。而进行数据传输时标志位都是为0，所以不用+1
3. 以太网1500B-20B IP头-20B TCP头=1460B，18BMAC帧头+尾
#### 四次挥手过程中seq和ack的值
| 方向   | seq   | ack        | FIN    | ACK       |
| ---- | ----- | ---------- | ------ | --------- |
| A->B | 80000 | 90000      | 1      | 1         |
| A状态  | 变为    | FIN-WAIT1  |        |           |
| B->A | 90000 | 80001      | 0      | 1         |
| B状态  | 变为    | CLOSE-WAIT | 发送完    | 剩下的数据     |
| B->A | 90000 | 80001      | 1      | 1         |
| B状态  | 变为    | LAST-ACK   |        |           |
| A->B | 80001 | 90001      | 0      | 1         |
| A状态  | 变为    | TIME-WAIT  | B收到后结束 | A过2MSL后结束 |
注：
1. MSL是报文段在网络上能存活的最大时间
## 3. TCP 可靠传输
- **可靠性**：确保接收方收到的数据与发送方发出的数据完全一致（顺序和内容）。
- **相关机制**：
    - **校验**：通过增加伪首部进行校验。与UDP一致，17改为6
    - **序号**：每个数据包都有序号，确保数据按顺序到达。
    - **确认**：接收方对数据包发送确认。
    - **重传**：若超时未收到确认，则重传数据包。
    - **重传时间（RTO）**：基于往返时间（RTT）计算，重传时间应略大于RTT。
    - **自适应算法**：根据每次测量的RTT计算加权平均，动态调整RTO。
	    - RTO=平均RTT + 4 * （新RTT与旧RTT的偏差）
    - **冗余ACK**：接收方在收到失序报文段时发送冗余确认，指示下一个期望的序号。
## 4. TCP 流量控制
- **控制发送速度**：利用滑动窗口机制调整数据发送速率。
- **接收窗口（rwnd）**：接收方根据缓存大小动态调整，并通过窗口字段告知发送方。
- **发送窗口（swnd）**：由接收窗口rwnd和拥塞窗口cwnd的最小值决定。
## 5. TCP 拥塞控制
- **目的**：防止过多数据注入网络，避免网络拥塞。
- **控制机制**：
    - **慢开始和拥塞避免**：拥塞窗口cwnd的维护原则:只要网络没有出现拥塞，拥塞窗口就再增大一些;但只要网络出现拥塞，拥塞窗口就减少一些。
    - **慢开始**：cwnd值增大。
    - **拥塞避免**：cwnd减小。
    - **慢开始门限（ssthresh）**：cwnd小于ssthresh时使用慢开始，大于时使用拥塞避免。
- ![Pasted image 20241212230954.png](../../pic/Pasted%20image%2020241212230954.png)
    - **快重传和快恢复**：通过快速识别丢包并重传。
    - **快重传**：接收方收到失序的报文段也要发送重复确认，发送方收到3个重复确认立即开始重传。
    - **快恢复**：==收到3个重复时使用==，发送方将慢开始门限ssthresh值和拥塞窗口cwnd值调整为当前窗口的一半;开始执行拥塞避免算法
- ![Pasted image 20241212231026.png](../../pic/Pasted%20image%2020241212231026.png)
    注：
    - 在TCP的慢启动阶段，拥塞窗口通常在每次收到一个确认（ACK）时增加。
	- 当TCP进入拥塞避免阶段时，拥塞窗口在收到每个确认段时只增加 1MSS/cwnd（cwnd一轮+1）。---
tags:
  - 计算机网络
---
# (一) 网络应用模型
1. **客户/服务器(C/S)模型**:
    - 客户端向服务器请求服务，服务器响应并处理请求。
    - 通常是基于集中式的架构，客户端依赖服务器提供数据和服务。
2. **对等(P2P)模型**:
    - 每个节点既是客户端也是服务器，能够同时提供和请求服务。
    - 常见于文件共享、即时通讯等应用。
# (二) DNS系统
1. **层次域名空间**:
    - 采用树状结构的命名方式，顶层为根域名，下面分为不同的顶级域（如.com、.org），再到次级域名等。
2. **域名服务器**:
    - **根域名服务器**: 查询顶级域名服务器的IP地址。
    - **顶级域名服务器**: 处理如 .com、.org 等域名。
    - **权限域名服务器**: 负责管理子域名的解析。
    - **本地域名服务器**: 存储本地网络的域名信息。
3. **域名解析过程**:
    - **递归查询**: 客户端请求时，DNS服务器会代为查询直到获取结果。
    - **迭代查询**: 客户端请求时，DNS服务器逐步返回指向其他服务器的查询地址。
# (三) FTP
1. **FTP 协议的工作原理**:
    - 提供不同种类主机系统之间的文件传输。
2. **控制连接与数据连接**:
    - **控制连接**: 服务器使用TCP端口21，等待客户连接，传输控制信息
    - **数据连接**: 传输文件数据。使用主动方式（TCP 20端口）或被动方式（端口>1024）。
# (四) 电子邮件
1. **电子邮件系统的组成结构**:
    - 使用SMTP和MIME推送邮件到邮件服务器
    - 接收人使用POP3/IMAP拉取邮件
    - 用户代理(UA)用户与电子邮件系统的接口。
1. **SMTP 协议与 MIME**:
	- **SMTP**: 仅限于 7位 ASCII 码，不能传送其他非英语国家的文字，使用TCP端口25。
    - **MIME** : 将非ASCII格式的内容（如图像、声音）转为ASCII格式，使邮件支持多种类型的内容。
2.  **POP3 协议和IMAP** 
    - **IMAP**：TCP 端口 143
    - **POP3**: TCP端口110。
# (五) WWW
1. **WWW 的概念与组成结构**:
    - 万维网（World Wide Web）是基于超文本协议的全球信息共享系统，包含网页、文件和多媒体内容。
	**组成**
	1. **统一资源定位符(URL)**: 唯一标识万维网上的文档，确保每个文档在全球范围内具有唯一标识。
	2. **超文本传输协议(HTTP)**: 应用层协议，通过TCP连接提供可靠的数据传输，用于客户程序和服务器程序之间的交互。
	3. **超文本标记语言(HTML)**: 标记语言，用于描述网页上的文本、图像、音视频等信息和格式。
2. **HTTP 协议**:
    - **特点**: 无状态、无连接，采用TCP进行数据传输。
    - **连接方式**:
        - **持久连接** (Keep-Alive): 保持连接以便多次请求。
        - **非持久连接** (Close): 每次请求后关闭连接。
        - **流水线**：一直发信息
        - **非流水线**：收到响应才发下一条信息
    - **HTTP 报文**:
        - **请求报文**: 客户端发起请求时的报文。
	        - 方法有GET，HEAD，POST，CONNECT
	        - CR LF表示回车 换行
        - **响应报文**: 服务器返回的报文。
![Pasted image 20241212224714.png](../../pic/Pasted%20image%2020241212224714.png)